var xe=Object.defineProperty,we=Object.defineProperties;var be=Object.getOwnPropertyDescriptors;var ee=Object.getOwnPropertySymbols;var ye=Object.prototype.hasOwnProperty,Ce=Object.prototype.propertyIsEnumerable;var G=(e,t,n)=>t in e?xe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,R=(e,t)=>{for(var n in t||(t={}))ye.call(t,n)&&G(e,n,t[n]);if(ee)for(var n of ee(t))Ce.call(t,n)&&G(e,n,t[n]);return e},F=(e,t)=>we(e,be(t));var w=(e,t,n)=>(G(e,typeof t!="symbol"?t+"":t,n),n);import{R as $,c as Y,f as M,s as X,a as Se,p as ke,b as r,d as N,e as S,r as k,g as te,o as Ne,G as Ie,h as Pe,i as I,j as B,k as Ee,F as Ae,w as ne,S as Be,E as _e,l as Me,m as oe,n as je,q as De,u as Oe,t as Re,v as Fe,x as $e,y as z,z as Ye,A as Xe,T as ze,B as se,C as re,D as ie,H as Le,I as Ve}from"./vendor.5a35bb36.js";const Ge=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const d of i.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&o(d)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerpolicy&&(i.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?i.credentials="include":s.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}};Ge();var q;(function(e){e[e.Add=0]="Add",e[e.Delete=1]="Delete",e[e.Move=2]="Move",e[e.Attr=3]="Attr"})(q||(q={}));class A{constructor(t){w(this,"parent");w(this,"children");w(this,"attrs");this.parent=t.parent,this.attrs=t.attrs,t.children&&(this.children=t.children)}}class qe{constructor(t){w(this,"type");w(this,"time");w(this,"data");this.time=t.time,this.type=t.type,this.data=t.data}}class We{constructor(t){w(this,"records",[]);w(this,"index",-1);w(this,"max");w(this,"recording");var n,o;this.max=(n=t==null?void 0:t.max)!=null?n:20,this.recording=(o=t==null?void 0:t.recording)!=null?o:!0}getPrevRecord(){if(!(this.index<0))return this.records[this.index]}getNextRecord(){if(!(this.index>=this.records.length-1))return this.records[this.index+1]}}function W(e){const t=D(e[0]);let n=t.position.x,o=t.position.x+t.size.width,s=t.position.y,i=t.position.y+t.size.height;return e.forEach(d=>{const a=D(d);a.position.x<n&&(n=a.position.x),o<a.position.x+a.size.width&&(o=a.position.x+a.size.width),a.position.y<s&&(s=a.position.y),i<a.position.y+a.size.height&&(i=a.position.y+a.size.height)}),{x:n,y:s,width:o-n,height:i-s}}function D(e){return e instanceof A?{position:{x:e.attrs.offsetX,y:e.attrs.offsetY},size:{width:e.attrs.width,height:e.attrs.height}}:{position:e.getProp("position"),size:e.getProp("size")}}function ae(e){const t=o(e),n=Number(t);return n?(n+1).toString():"1";function o(s){var c;const i=s.attrs.id;let d="";if((c=s.children)==null?void 0:c.length)for(const v of s.children){const u=o(v),p=Number(d),x=Number(u);p&&x&&(d=Math.max(p,x).toString()),x&&(d=u)}const a=Number(d),l=Number(i);return a&&l?Math.max(a,l).toString():a?d:i}}function He(e,t){return new t({attrs:e.data,parent:void 0,children:[]})}function H(e,t){const n=Array.isArray(e)?e:[e],o=t.getSelectedCells().filter(s=>!n.includes(s.data.id));for(const s of n)t.isSelected(s)||t.select(s);for(const s of o)t.unselect(s)}var b;(function(e){e[e.Canvas=1]="Canvas",e[e.Button=2]="Button",e[e.Container=3]="Container"})(b||(b={}));function L(e){const t=Object.assign({id:e.attrs.id,x:e.attrs.offsetX,y:e.attrs.offsetY,width:e.attrs.width,height:e.attrs.height},{data:e.attrs});switch(e.attrs.type){case b.Button:return new $(F(R({},t),{attrs:{rect:{fill:"#31D0C6",stroke:"#4B4A67",strokeWidth:1},text:{text:b[e.attrs.type],fill:"white"}}}));case b.Container:return new $(F(R({},t),{attrs:{rect:{fill:"#31D0C6",stroke:"#4B4A67",strokeWidth:1}}}));default:throw new Error(`[Sa error]: unexpected element type ${e.attrs.type}.`)}}class Ke{constructor(){w(this,"clips")}isEmpty(t=this.clips){var n;return!((n=this.clips)==null?void 0:n.elements.length)}copy(t,n){this.clips={elements:Y(t.selected),type:"copy"}}cut(t,n){this.clips={elements:Y(t.selected),type:"cut"}}paste(t,n=t.canvas.attrs.id,o){if(this.isEmpty(this.clips)||!t.graph)return;const s=M(t.canvas,l=>l.attrs.id===n);if(!s)return;const d=this.clips.elements.map(l=>{let c=new A(F(R({},l),{parent:s}));return(o==null?void 0:o.nodeProps)&&X(c.attrs,o.nodeProps(l)),c}).map(l=>L(l)),a=n?t.graph.getCellById(s.attrs.id):void 0;if(a){for(const l of d)l.setParent(a);a.setChildren(d)}t.graph.addNodes(d)}}class Te{constructor(t){w(this,"type");w(this,"canvas");w(this,"history");w(this,"clipboard");w(this,"selected",[]);w(this,"graph");this.type="PcForm",this.history=new We,this.clipboard=new Ke,this.canvas=new A({parent:void 0,children:[],attrs:t.attrs})}setCanvas(t){this.canvas=t,this.selected=[t]}setGraph(t){this.graph=t}addChild(t,n){var s;const o=(s=typeof n=="string"?Se(this.canvas.children,i=>i.attrs.id===n):n)!=null?s:this.canvas;return o.children&&o.children.push(t),o}setSelected(t){if(!!this.graph){if(!arguments.length||Array.isArray(t)&&!t.length)return this.selected=[this.canvas],this.canvas;if(!!this.canvas.children){if(typeof t=="string"){const n=M(this.canvas,o=>o.attrs.id===t);return n&&(this.selected=[n],H(t,this.graph)),n}if(Array.isArray(t)){const n=[];for(const o of t)if(typeof o=="string"){const s=M(this.canvas,i=>i.attrs.id===o);s&&n.push(s)}else n.push(o);return H(n.map(o=>o.attrs.id),this.graph),this.selected=n,n}if(typeof t=="object")return this.selected=[t],H(t.attrs.id,this.graph),t}}}updateElemData(t,n){const o=typeof t=="string"?M(this.canvas,i=>i.attrs.id===t):t;if(!o)return;const s=new qe({type:q.Attr,time:new Date,data:[{id:o.attrs.id,prev:Y(ke(o.attrs,Object.keys(n))),next:Y(n)}]});return this.addRecord(s),K(this,o.attrs.id,n),X(o.attrs,n),o}addRecord(t){console.log("[Sa info]: New record has been added.",t),this.history.index&&this.history.records.length>this.history.index+1&&this.history.records.splice(this.history.index+1),this.history.records.push(t),this.history.index+=1}undo(){const t=this.history.getPrevRecord();if(!t){console.warn("[Sa warn]: None previous record in history.");return}for(const n of t.data){const o=M(this.canvas,s=>s.attrs.id===n.id);o&&(X(o.attrs,n.prev),K(this,n.id,n.prev))}this.setSelected(t.data.map(n=>n.id)),this.history.index-=1}redo(){const t=this.history.getNextRecord();if(!t){console.warn("[Sa warn]: None next record in history.");return}for(const n of t.data){const o=M(this.canvas,s=>s.attrs.id===n.id);o&&(X(o.attrs,n.next),K(this,n.id,n.next))}this.setSelected(t.data.map(n=>n.id)),this.history.index+=1}}function K(e,t,n){var s,i,d,a,l,c;if(!e.graph)return;const o=e.graph.getCellById(t);if(o){const v=D(o);o.setProp({position:{x:(s=n.offsetX)!=null?s:v.position.x,y:(i=n.offsetY)!=null?i:v.position.y},size:{width:(d=n.width)!=null?d:v.size.width,height:(a=n.height)!=null?a:v.size.height}})}else e.graph.size.resize((l=n.width)!=null?l:e.canvas.attrs.width,(c=n.height)!=null?c:e.canvas.attrs.height)}const Ue=[{title:"undo",icon:r("span",null,[N("undo")]),click:e=>e.undo()},{title:"redo",icon:r("span",null,[N("redo")]),click:e=>e.redo()}],Je=[{title:"Button",icon:r("span",null,[N("Button")])},{title:"Container",icon:r("span",null,[N("container")])}],Qe=()=>{var s;const e=new A({parent:void 0,children:[],attrs:{type:b.Canvas,id:"1",name:"mock pc form",width:800,height:600,offsetX:0,offsetY:0}}),t=new A({parent:e,attrs:{id:"2",type:b.Button,name:"mock button 1",width:80,height:40,offsetX:200,offsetY:100}}),n=new A({parent:e,attrs:{type:b.Button,id:"3",name:"mock button 2",width:80,height:40,offsetX:150,offsetY:200}}),o=new A({parent:e,attrs:{type:b.Container,id:"4",name:"mock container",width:400,height:200,offsetX:50,offsetY:300}});return(s=e.children)==null||s.push(t,n,o),e};function le(e,t){if(!e)return;let n;if(t)return typeof t=="object"?n=t.toJSON().id:n=t,e.removeNode(n);const o=e.getSelectedCells();if(o.length)for(const s of o)le(e,s)}function Ze(e){e.clipboard.copy(e,{deep:!0,useLocalStorage:!0})}function ue(e,t,n){if(n.clipboard.isEmpty(n.clipboard.clips)||!n.graph)return;if(t&&t.data.type!==b.Container)return console.error(`[Sa error]: can not paste elements in ${b[t.data.type]}.`);const o=W(n.clipboard.clips.elements),s=o.x-e.offsetX,i=o.y-e.offsetY,d=n.clipboard.paste(n,t==null?void 0:t.data.id,{deep:!0,nodeProps:a=>({id:ae(n.canvas),offsetX:a.attrs.offsetX-s,offsetY:a.attrs.offsetY-i})});d&&(n.graph.cleanSelection(),n.graph.select(d==null?void 0:d.map(a=>a.attrs.id)))}function et(e){if(!e)return;const t=e.getSelectedCells();e.cut(t,{deep:!0,useLocalStorage:!0})}var tt=S({name:"SaPcFormRender",props:{drawer:{required:!0,type:Object}},setup(e){const t=k(null),n=k(null),o=k([]),s=te(),i=te();Ne(()=>{var a;if(t.value){const l=Qe();console.log("create graph",l);const c=new Ie({container:t.value,width:l.attrs.width,height:l.attrs.height,snapline:!0,grid:{visible:!0,type:"doubleMesh",args:[{color:"#eee",thickness:1},{color:"#ddd",thickness:1,factor:4}]},selecting:{enabled:!0,multiple:!0,rubberband:!0,movable:!0,showEdgeSelectionBox:!0},resizing:!0,translating:{restrict(u){var _;const p=u.cell,x=u.graph.selection;if(p.isNode()){const E=p.getParent();if(E){const h=E.getBBox();if((_=x==null?void 0:x.cells)==null?void 0:_.length){const g=W(x.cells),m=D(p);return{x:h.x+m.position.x-g.x,y:h.y+m.position.y-g.y,width:h.width-(g.width-m.size.width),height:h.height-(g.height-m.size.height)}}return h}if(x==null?void 0:x.length){const h=W(x.cells),g=D(p);return{x:g.position.x-h.x,y:g.position.y-h.y,width:l.attrs.width-(h.width-g.size.width),height:l.attrs.height-(h.height-g.size.height)}}}return{x:0,y:0,width:l.attrs.width,height:l.attrs.height}}},clipboard:{enabled:!0,useLocalStorage:!0}});Pe(e.drawer).setGraph(c).setCanvas(l);const v=(a=l.children)==null?void 0:a.map(u=>L(u));v&&c.addNodes(v),c.enableHistory(),c.on("blank:mousedown",()=>{c.cleanSelection(),n.value.hide()}),c.on("blank:contextmenu",({e:u})=>{c.cleanSelection(),i.value=void 0,s.value=u,n.value.show(u.originalEvent)}),c.on("cell:mousedown",({cell:u})=>{u.toFront({deep:!0}),n.value.hide()}),c.on("cell:contextmenu",({cell:u,e:p})=>{c.isSelected(u)||(c.cleanSelection(),c.select(u)),i.value=u,s.value=p,n.value.show(p.originalEvent)}),c.on("selection:changed",({selected:u})=>{o.value=u,e.drawer.setSelected(u.map(p=>p.data.id)),u.length>1?c.disableSnapline():c.enableSnapline()}),c.on("node:added",({cell:u})=>{console.log("added",u);const p=He(u,A);e.drawer.addChild(p)}),c.on("node:moved",({cell:u})=>{const{x:p,y:x}=u.position();e.drawer.updateElemData(u.data.id,{offsetX:p,offsetY:x})}),c.on("node:resized",({cell:u})=>{const{width:p,height:x}=u.size();e.drawer.updateElemData(u.data.id,{width:p,height:x})})}});const d=I(()=>o.value.length?r(Ae,null,[r(B("v-contextmenu-item"),{onClick:()=>Ze(e.drawer)},{default:()=>[N("copy")]}),r(B("v-contextmenu-item"),{onClick:()=>et(e.drawer.graph)},{default:()=>[N("cut")]}),r(B("v-contextmenu-item"),{onClick:()=>ue(s.value,i.value,e.drawer)},{default:()=>[N("paste")]}),r(B("v-contextmenu-item"),{type:"danger",icon:r(Ee,null,null),onClick:()=>le(e.drawer.graph)},{default:()=>[N("delete")]})]):r(B("v-contextmenu-item"),{onClick:()=>ue(s.value,void 0,e.drawer)},{default:()=>[N("paste")]}));return{workspace:t,contextmenu:n,selectedCells:o,graphContextmenu:d}},render(){return r("div",null,[r("div",{ref:"workspace"},null),r(B("v-contextmenu"),{ref:"contextmenu"},{default:()=>[this.graphContextmenu]})])}}),P;(function(e){e.Input="input",e.Number="number",e.Select="select",e.Dialog="dialog",e.Color="color",e.Cascader="cascader"})(P||(P={}));const y={"widget-id":{label:"id",attr:"id",component:P.Input,disabled:!0},"widget-name":{label:"name",attr:"name",component:P.Input},"widget-width":{label:"width",attr:"width",component:P.Number},"widget-height":{label:"height",attr:"height",component:P.Number},"widget-offsetX":{label:"x",attr:"offsetX",component:P.Number},"widget-offsetY":{label:"y",attr:"offsetY",component:P.Number}},nt={[b.Canvas]:{basic:[y["widget-id"],y["widget-name"],y["widget-width"],y["widget-height"]]},[b.Container]:{basic:[y["widget-id"],y["widget-name"],y["widget-width"],y["widget-height"],y["widget-offsetX"],y["widget-offsetY"]]},[b.Button]:{basic:[y["widget-id"],y["widget-name"],y["widget-width"],y["widget-height"],y["widget-offsetX"],y["widget-offsetY"]]}};function ot(e,t,n){const o=n.selected[0];!o||n.updateElemData(o,{[e]:t})}const st=()=>({drawer:new Te({attrs:{type:b.Canvas,id:"1",name:"Pc Form Demo",width:800,height:600,offsetX:0,offsetY:0}}),header:Ue,side:Je,workspace:tt,controller:{plugins:nt,valueChange:ot}}),rt={PcForm:()=>st()};var it=S({name:"SaFormLayoutHeader",props:{options:{required:!0,type:Array},drawer:{required:!0,type:Object}},render(){return r("div",{class:"sa-form-header flex justify-start p-1"},[this.options.map(e=>r("span",{class:"header-tool",onClick:t=>e.click(this.drawer,t),title:e.title,style:{width:e.width?`${e.width}px`:"30px",height:"30px"}},[e.icon]))])}}),at=S({name:"CoFormLayoutSidebar",props:{options:{required:!0,type:Array},drawer:{required:!0,type:Object}},setup(e){const t=k(null),n=I(()=>e.drawer.graph);let o;return ne(()=>n.value,()=>{var s;if(console.log("GRAPH CHANGE"),n.value&&!o){console.log(n.value,t.value),o=new Be({title:"Components",target:n.value,scaled:!1,animation:!0,search(a,l){const c=a.attrs.text.text;return new RegExp(l,"i").test(c)},placeholder:"Search by shape name",notFoundText:"Not Found",collapsable:!0,stencilGraphWidth:208,stencilGraphHeight:180,groups:[{name:"group1",title:"Group(Collapsable)"},{name:"group2",title:"Group",collapsable:!1}],getDragNode(a){var v;const l=ae(e.drawer.canvas),c=e.drawer.canvas;switch((v=a.attrs)==null?void 0:v.text.text){case"Button":return L({attrs:{id:l,name:"Button",width:80,height:40,type:b.Button,offsetX:0,offsetY:0},parent:c});case"Container":return L({attrs:{id:l,name:"Container",width:200,height:100,type:b.Container,offsetX:0,offsetY:0},parent:c});default:console.error("[Sa error]: unexpected drag node",a)}return a}});const i=new $({width:80,height:40,attrs:{rect:{fill:"#31D0C6",stroke:"#4B4A67",strokeWidth:1},text:{text:"Button",fill:"white"}}}),d=new $({width:80,height:40,attrs:{rect:{fill:"#31D0C6",stroke:"#4B4A67",strokeWidth:1},text:{text:"Container",fill:"white"}}});(s=t.value)==null||s.appendChild(o.container),o.load([i],"group1"),o.load([d],"group2")}}),{graph:n,refStencil:t,stencil:o}},render(){return r("div",{class:"sa-form-side flex flex-col justify-start p-1 relative w-52"},[r("div",{ref:"refStencil"},null)])}});function ce(e,t,n,o){o(e.attr,t,n)}function lt(e,t,n){var i,d;const o=t.selected[0];let s;if(o&&ut(e.attr,o)&&(s=o==null?void 0:o.attrs[e.attr]),s===void 0)return r("span",null,null);switch(e.component){case P.Input:return r(Me,{modelValue:s,onInput:a=>ce(e,a,t,n.valueChange),disabled:(i=e.disabled)!=null?i:!1},null);case P.Number:return r(_e,{controls:!1,modelValue:s,onInput:a=>ce(e,a,t,n.valueChange),disabled:(d=e.disabled)!=null?d:!1},null);default:return console.error(`[Sa error]: unexpected plugin type ${e.component}.`),r("span",null,[e.label])}}function ut(e,t){return Reflect.has(t.attrs,e)}var ct=S({name:"ControllerItem",props:{plugin:{required:!0,type:Object},drawer:{required:!0,type:Object},controller:{required:!0,type:Object}},setup(e){const t=I(()=>lt(e.plugin,e.drawer,e.controller));return()=>r("div",null,[t.value])}});var dt=S({name:"SaFormLayoutController",props:{drawer:{required:!0,type:Object},controller:{required:!0,type:Object}},setup(e){const t=I(()=>{var o;const n=(o=e.drawer.selected[0])==null?void 0:o.attrs.type;if(n&&e.controller.plugins[n])return e.controller.plugins[n]});return()=>{var n;return r("div",{class:"controller-container"},[t.value?(n=t.value.basic)==null?void 0:n.map(o=>r("div",{class:"controller-item"},[r("div",{class:"controller-item-label"},[o.label]),r("div",{class:"controller-item-plugin"},[r(ct,{plugin:o,drawer:e.drawer,controller:e.controller},null)])])):""])}}}),ht=S({props:{type:{required:!0,type:String},id:{required:!0,type:String}},setup(e,t){const n=oe(rt[e.type]()),o=n.workspace;return()=>r("section",{class:"flex flex-col"},[r("h1",{class:"font-bold text-lg py-4"},[N("Sa Form")]),r("header",null,[r(je,null,{default:()=>[r(it,{options:n.header,drawer:n.drawer,class:"bg-slate-500"},null)]})]),r("main",{class:"mt-1 flex flex-grow"},[r("aside",null,[r(at,{options:n.side,drawer:n.drawer,class:"bg-slate-500 h-full"},null)]),r("main",{class:"flex-grow justify-center bg-slate-500 mx-1 overflow-auto"},[r(o,{drawer:n.drawer},null)]),r("aside",{class:"w-52 bg-slate-500"},[r(dt,{drawer:n.drawer,controller:n.controller},null)])])])}});const mt={class:"w-3/5 mx-auto h-full"},ft=S({setup(e){return(t,n)=>(Re(),De("div",mt,[r(Oe(ht),{id:"1",type:"PcForm",class:"h-1/2"})]))}});const de=(e,t)=>{var i;const n=t.arg||t.value;if(!n){console.error("\u53C2\u6570\u6709\u8BEF");return}const o=t.value,s=Fe(n)?n.value:(i=t.instance)==null?void 0:i.$refs[n];if(!s){console.error(`\u6CA1\u6709\u627E\u5230 ${n} \u5BF9\u5E94\u7684\u5B9E\u4F8B`);return}if(typeof s.addReference!="function"){console.error(`${n} \u5BF9\u5E94\u7684\u5B9E\u4F8B\u4E0D\u662F VContextmenu`);return}e.$contextmenuKey=n,s.addReference(e,o)},he=(e,t)=>{var s;const n=e.$contextmenuKey;if(!n)return;const o=(s=t.instance)==null?void 0:s.$refs[n];o==null||o.removeReference(e)},pt=(e,t)=>{he(e,t),de(e,t)},gt={mounted:de,updated:pt,beforeUnmount:he},f={contextmenu:"v-contextmenu",contextmenuIcon:"v-contextmenu-icon",contextmenuInner:"v-contextmenu-inner",contextmenuDivider:"v-contextmenu-divider",contextmenuItem:"v-contextmenu-item",contextmenuItemHover:"v-contextmenu-item--hover",contextmenuItemDisabled:"v-contextmenu-item--disabled",contextmenuItemDanger:"v-contextmenu-item--danger",contextmenuGroup:"v-contextmenu-group",contextmenuGroupTitle:"v-contextmenu-group__title",contextmenuGroupMenus:"v-contextmenu-group__menus",contextmenuSubmenu:"v-contextmenu-submenu",contextmenuSubmenuTitle:"v-contextmenu-submenu__title",contextmenuSubmenuMenus:"v-contextmenu-submenu__menus",contextmenuSubmenuMenusTop:"v-contextmenu-submenu__menus--top",contextmenuSubmenuMenusRight:"v-contextmenu-submenu__menus--right",contextmenuSubmenuMenusBottom:"v-contextmenu-submenu__menus--bottom",contextmenuSubmenuMenusLeft:"v-contextmenu-submenu__menus--left",contextmenuSubmenuArrow:"v-contextmenu-submenu__arrow"};function vt(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!se(e)}const xt={trigger:["contextmenu"]},me=S({name:"VContextmenu",props:{modelValue:{type:Boolean,default:!1},autoAjustPlacement:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},teleport:{type:[String,Object],default:()=>"body"}},emits:["show","hide","update:modelValue"],setup(e,{emit:t}){const n=k(null),o=k(e.modelValue||!1),s=h=>{o.value=h,t("update:modelValue",h)},i=k({top:0,left:0}),d=I(()=>({top:`${i.value.top}px`,left:`${i.value.left}px`})),a=k(null),l=(h,g)=>{var U,J;const m=h instanceof Event?g:h,O=(m==null?void 0:m.autoAjustPlacement)||e.autoAjustPlacement,C={top:(m==null?void 0:m.top)||0,left:(m==null?void 0:m.left)||0};h instanceof Event&&(h.preventDefault(),C.top=(U=m==null?void 0:m.top)!=null?U:h.pageY,C.left=(J=m==null?void 0:m.left)!=null?J:h.pageX),s(!0),re(()=>{if(O){const V=n.value;if(!V)return;const Q=V.clientWidth,Z=V.clientHeight;if(Z+C.top>=window.innerHeight+window.scrollY){const j=C.top-Z;j>window.scrollY&&(C.top=j)}if(Q+C.left>=window.innerWidth+window.scrollX){const j=C.left-Q;j>window.scrollX&&(C.left=j)}}i.value=C,t("show")})},c=()=>{a.value=null,s(!1),t("hide")},v=oe(new Map),u=k(),p=I(()=>u.value&&v.get(u.value)),x=(h,g)=>{const m=(()=>(g==null?void 0:g.trigger)?Array.isArray(g.trigger)?g.trigger:[g.trigger]:xt.trigger)(),O=C=>{e.disabled||(u.value=h,l(C,{}))};m.forEach(C=>{h.addEventListener(C,O)}),v.set(h,{triggers:m,handler:O})},_=h=>{const g=v.get(h);!g||(g.triggers.forEach(m=>{h.removeEventListener(m,g.handler)}),v.delete(h))},E=h=>{if(!h.target||!n.value||!u.value)return;n.value.contains(h.target)||p.value&&p.value.triggers.includes("click")&&u.value.contains(h.target)||s(!1)};return ne(o,h=>{h?document.addEventListener("click",E):document.removeEventListener("click",E)}),$e(()=>{document.removeEventListener("click",E)}),z("visible",o),z("autoAjustPlacement",e.autoAjustPlacement),z("show",l),z("hide",c),{visible:o,style:d,currentReferenceOptions:p,currentOptions:a,contextmenuRef:n,addReference:x,removeReference:_,toggle:s,show:l,hide:c}},methods:{renderContent(){var e,t;return Ye(r("div",{class:f.contextmenu,ref:"contextmenuRef",style:this.style},[r("ul",{class:f.contextmenuInner},[(t=(e=this.$slots).default)==null?void 0:t.call(e,{triggerOptions:"currentReferenceOptions",options:"currentOptions"})])]),[[Xe,"visible"]])}},render(){let e;return this.visible?this.teleport?r(ze,{to:this.teleport},vt(e=this.renderContent())?e:{default:()=>[e]}):this.renderContent():null}});function wt(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!se(e)}const fe=S({name:"VContextmenuItem",props:{disabled:{type:Boolean,default:!1},hideOnClick:{type:Boolean,default:!0},icon:{required:!1,type:Object},type:{requred:!1,type:String}},emits:["click","mouseenter","mouseleave"],setup(e,{emit:t}){const n=ie("hide"),o=k(!1);return{classes:I(()=>({[f.contextmenuItem]:!0,[f.contextmenuItemDisabled]:e.disabled,[f.contextmenuItemHover]:o.value,[f.contextmenuItemDanger]:e.type==="danger"})),handleClick:l=>{e.disabled||(t("click",l),e.hideOnClick&&(n==null||n()))},handleMouseenter:l=>{e.disabled||(o.value=!0,t("mouseenter",l))},handleMouseleave:l=>{e.disabled||(o.value=!1,t("mouseleave",l))}}},render(){var t,n;const e=this.icon;return r("li",{class:this.classes,onClick:this.handleClick,onMouseenter:this.handleMouseenter,onMouseleave:this.handleMouseleave},[e?r(B("el-icon"),{class:"mr-1 leading-0"},wt(e)?e:{default:()=>[e]}):r("span",{style:{width:"18px"}},null),(n=(t=this.$slots).default)==null?void 0:n.call(t)])}}),pe=S({name:"VContextmenuDivider",render(){return r("li",{class:f.contextmenuDivider},null)}}),bt=S({name:"VContextmenuIcon",props:{name:{type:String,required:!0}},render(){return r("i",{class:[f.contextmenuIcon,`${f.contextmenuIcon}-${this.name}`]},null)}}),ge=S({name:"VContextmenuSubmenu",props:{title:{type:String,required:!0},disabled:{type:Boolean,default:!1}},emits:["mouseenter","mouseleave"],setup(e,{emit:t}){const n=k(null),o=ie("autoAjustPlacement"),s=k(["top","right"]),i=k(!1),d=v=>{e.disabled||(i.value=!0,t("mouseenter",v),re(()=>{const u=[];if(o){const{target:p}=v,x=p.getBoundingClientRect();if(!n.value)return;const _=n.value.clientWidth,E=n.value.clientHeight;x.right+_>=window.innerWidth?u.push("left"):u.push("right"),x.bottom+E>=window.innerHeight?u.push("bottom"):u.push("top")}s.value=u}))},a=v=>{e.disabled||(i.value=!1,t("mouseleave",v))},l=I(()=>({[f.contextmenuItem]:!0,[f.contextmenuSubmenuTitle]:!0,[f.contextmenuItemHover]:i.value,[f.contextmenuItemDisabled]:e.disabled})),c=I(()=>({[f.contextmenu]:!0,[f.contextmenuSubmenuMenus]:!0,[f.contextmenuSubmenuMenusTop]:s.value.includes("top"),[f.contextmenuSubmenuMenusRight]:s.value.includes("right"),[f.contextmenuSubmenuMenusBottom]:s.value.includes("bottom"),[f.contextmenuSubmenuMenusLeft]:s.value.includes("left")}));return{hover:i,submenuRef:n,titleClasses:l,menusClasses:c,handleMouseenter:d,handleMouseleave:a}},render(){var e,t,n,o;return r("li",{class:f.contextmenuSubmenu,onMouseenter:this.handleMouseenter,onMouseleave:this.handleMouseleave},[r("div",{class:this.titleClasses},[((t=(e=this.$slots).title)==null?void 0:t.call(e))||this.title,r("span",{class:f.contextmenuSubmenuArrow},[r(bt,{name:"right-arrow"},null)])]),this.hover?r("div",{ref:"submenuRef",class:this.menusClasses},[r("ul",{class:f.contextmenuInner},[(o=(n=this.$slots).default)==null?void 0:o.call(n)])]):null])}}),ve=S({name:"VContextmenuGroup",props:{title:{type:String,default:void 0},maxWidth:{type:[Number,String],default:void 0}},setup(e){return{style:I(()=>{if(!!e.maxWidth)return{"max-width":typeof e.maxWidth=="number"?`${e.maxWidth}px`:e.maxWidth,"overflow-x":"auto"}})}},methods:{renderTitle(){var t,n;const e=((n=(t=this.$slots).title)==null?void 0:n.call(t))||this.title;return e?r("div",{class:f.contextmenuGroupTitle},[e]):null}},render(){var e,t;return r("li",{class:f.contextmenuGroup},[this.renderTitle(),r("ul",{style:this.style,class:f.contextmenuGroupMenus},[(t=(e=this.$slots).default)==null?void 0:t.call(e)])])}}),yt=e=>{e.directive("contextmenu",gt),e.component(me.name,me),e.component(fe.name,fe),e.component(pe.name,pe),e.component(ge.name,ge),e.component(ve.name,ve)},Ct={install:yt},T=Le(ft);T.use(Ct);T.use(Ve);T.mount("#app");
